<% content_for(:title, "パスワードの変更") %>

<div class="container">
  <div class="row justify-content-center">
    <div class="col-5 my-5 py-5">
      <%= form_with model: @user, url: password_reset_path(@token), local: true do |f| %>
        <h3 class="mt-5">パスワードの変更</h3>
        <div class="mt-5">
          <%= f.label :password, "新しいパスワード" %>
          <div class="mb-1"><small>8文字以上で設定してください</small></div>
          <%= f.password_field :password, class: 'form-control', id: "userchangepass" %>
          <input type="checkbox" class="mt-2" onChange="document.getElementById('userchangepass').type = (this.checked) ? 'text' : 'password';">　パスワードを表示する
        </div>
        <div class="mt-5">
          <%= f.label :password_confirmation, "新しいパスワード（確認用）" %>
          <%= f.password_field :password_confirmation, class: 'form-control', id: "userchangepassconfirmation" %>
          <input type="checkbox" class="mt-2" onChange="document.getElementById('userchangepassconfirmation').type = (this.checked) ? 'text' : 'password';">　パスワードを表示する
        </div>
        <div class="text-center mt-5">
          <% if logged_in? %>
            <%= link_to "戻る", new_password_reset_path, class: "btn btn-secondary mx-4 px-5" %>
          <% else %>
            <%= link_to "戻る", login_path, class: "btn btn-secondary mx-4 px-5" %>
          <% end %>
          <%= f.submit "保存", class: "btn btn-primary px-5 my-4" %>
        </div>
      <% end %>
    </div>
  </div>
</div>

戻るボタンをログイン状態の有無によって戻り先を変える